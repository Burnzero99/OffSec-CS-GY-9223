#from Crypto.PublicKey import RSA
import gmpy2
from gmpy2 import mpz
from Crypto.Util.number import *
from egcd import egcd

n = mpz(203987152902617493887478417163275424824553528281466324414136651599201389937939307108593984437875654772187116526577657818294957105747803227016855029022843193600847788045050184416977991275660587098359941284449134179778244806833807212652133786087780589364700683839967735308749757347391640592238579872277574176993297365380106297276123797346858409855277674844529444728529967485944325469997082154593550271548939122748870977340345838737686544936893935325641692459278061688387617135499365028667218840725897649905110088824640057949507482051296295401242868788518705217231274004508396387691190247514439238618309345057348662853182818808933000644189060799377832213633816373345001119319358600831219988205738278203243757378711431372744608374219642483717851753838086840933002007159686242279061999035400007528806964246573467868440703269303426265236689060309593602335422805630370966061727894157873787868802632055163344355397837762167103803469736247571652882324455971581954205378181339081511765419429268697295644714394978866376757362863467054529483381967011801150710143589724484104299665442304824793538769718132208294358050920150617946801895834067081305731386230210799739714854016949666543959674529704305829826190839940180901780826062812539363799548209)


c = mpz(186700254829473832527230624084063619946989863157875563011632304209465234639024690697340110951153623386885443192566114458625334586344179290228908791268870427784278013525952459424319638725085385025174364989863703375244100567496675344711778755801890834740521873301436033795552245692705699916218892327907509154791499422906140587063422868273246129952794102740885868165985357634273084116111304828517373318347490678397481089844158947541521192502996616313055116300194517274227593282961499639663873591267641264244360303002106131241739833870706663886887160096547513402066395116221658531819509038515435262457830692399044736652697549371405384835383339185841530961180900808097495972811132633799410365367675458166362145020666245839694623876534363972882833883854071545421248188319470287084478849401317019266867577070204820705224467592355125252433127422779894816031490222951277189245272258823883207845874864437481757213517289761005782856566562609351648481510367544001835996205295341377267197715000763750831915915760666737125646315988112053320596747906520084082968036834600743565064671580296581829357475498201044737104463699973406537934439271706344315864412045697227141552283140483525462844601199499657557198806808707325012085761708440460361087553475)
e=257

c2 = mpz(175280506696925679140448522415300285836704080347788920793643935226195357211490096688576121129857116302586810726694946588492305400011686409250220966865501301460093683157119457577768985323029346082322824253513978226425902422382799546176114164694915187522074178656442966068713774090338991427297069244756702560110393723157557757764979549624022697289743026954339314641916336303963713972166591731010041762749305920459451059551602224975460561810846733130271301582189695830959273420245719148004014371469195121413921788572105212540990587935322098700194426155479962379735743229453533231811617863677487498293018999606518958789648291058771527217906021232832944058804673285923058662543377955973041259511575752680130406415891524691686164309736321536592138750466565180451623658016478989989429883673827685614190007348659794564706260193394826049391558011502394666928444651343299967733815535803716796237386829940820823196811329813004016666254026254202084363953740419136105141541557167603186956214992418478301103202330649974681361277034385095676829322360826154135327062385933990482611547831008040603244164854806374626184911136909271054171923550823498982180542566433145977531460449863459679516219049600140979933666138540136648847411893667250695555345240)
e2=65537

# Find x and y such that e*x + e2*y = 1 (Extended Euclidean)
# Both e values must be coprime (can verify with egcd if gcd is one)

gcd, x, y = egcd(e, e2)

# (c ** x) * (c2 ** y) = m mod n

# If y is negative
# (c ** x) *(inv(c2) ** -y) = m mod n

c2_inv = gmpy2.invert(c2, n)

m = (gmpy2.powmod(c,x,n) * gmpy2.powmod(c2_inv, y*(-1), n))%n

print(long_to_bytes(m))
